## ğŸ’¾æ•°æ®åº“

  * [æ•°æ®åº“](#æ•°æ®åº“)
    * [å¸¸ç”¨æ•°æ®åº“](#å¸¸ç”¨æ•°æ®åº“)
    * [Redis](#redis)
    * [MongoDB](#mongodb)
  * [äº‹åŠ¡](#%E4%BA%8B%E5%8A%A1)
    * [3ç§å¹¶å‘é—®é¢˜](#3ç§å¹¶å‘é—®é¢˜)
    * [å››å¤§ç‰¹æ€§](#å››å¤§ç‰¹æ€§)
    * [5ç§äº‹åŠ¡éš”ç¦»çº§åˆ«](#5%E7%A7%8D%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB)
    * [åŠ é”åè®®](#åŠ é”åè®®)
    * [ä¸¤/ä¸‰é˜¶æ®µæäº¤](#%E4%B8%A4%E4%B8%89%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4)
  * [ç¼“å­˜](#%E7%BC%93%E5%AD%98)
    * [ç¼“å­˜ç©¿é€](#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F)
    * [ç¼“å­˜é›ªå´©](#%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9)
  * [ä¼˜åŒ–](#%E4%BC%98%E5%8C%96)
    * [æ•°æ®åº“ä¼˜åŒ–](#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96)
    * [æ•°æ®åº“åˆ‡åˆ†](#æ•°æ®åº“åˆ‡åˆ†)
    * [è®¡æ•°å™¨è¡¨](#%E8%AE%A1%E6%95%B0%E5%99%A8%E8%A1%A8)
    * [SQLæŠ€å·§](#SQLæŠ€å·§)
  * [åŸºç¡€çŸ¥è¯†](#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86)
    * [ä¸‰å¤§èŒƒå¼](#%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F)
    * [äº”å¤§çº¦æŸ](#%E4%BA%94%E5%A4%A7%E7%BA%A6%E6%9D%9F)
    * [ç´¢å¼•](#%E7%B4%A2%E5%BC%95)
    * [count(1) count(ä¸»é”®) count(\*)](#count1-count%E4%B8%BB%E9%94%AE-count)
    * [Limit](#limit)
    * [Select For update](#select-for-update)

### æ•°æ®åº“
#### å¸¸ç”¨æ•°æ®åº“
+ [Oracle](https://www.oracle.com/cn/index.html)
+ [MySQL](https://www.mysql.com/)
+ [Microsoft SQL Server]()
+ [PostgreSQL](https://www.postgresql.org/)
+ [MongoDB](https://www.mongodb.com/)
+ [Redis](https://redis.io/)
+ Microsoft Access

#### Redis
åŸºäºå†…å­˜çš„é‡‡ç”¨çš„ã€å•è¿›ç¨‹å•çº¿ç¨‹ã€‘æ¨¡å‹çš„KVæ•°æ®åº“ï¼Œç”±Cè¯­è¨€ç¼–å†™ã€‚
+ ä¸ºä»€ä¹ˆå¿«
  + å®Œå…¨åŸºäºå†…å­˜ï¼›
  + å•çº¿ç¨‹é¿å…äº†å¤šçº¿ç¨‹çš„é¢‘ç¹ä¸Šä¸‹æ–‡åˆ‡æ¢é—®é¢˜ï¼›
  + åŸºäºéé˜»å¡çš„IOå¤šè·¯å¤ç”¨æœºåˆ¶ï¼›
  + æ•°æ®ç»“æ„ç®€å•ï¼Œå¯¹æ•°æ®æ“ä½œä¹Ÿç®€å•ï¼›
  + åº•å±‚æ¨¡å‹ï¼šRedisç›´æ¥è‡ªå·±æ„å»ºäº†VMæœºåˆ¶ï¼›
+ æ•°æ®ç»“æ„
  + Stringï¼šç¼“å­˜ã€é™æµã€è®¡æ•°å™¨ã€åˆ†å¸ƒå¼é”ã€åˆ†å¸ƒå¼Session
    + åº•å±‚å®ç°ï¼šintã€rawã€embstr
    + embstrï¼š<=39å­—èŠ‚çš„å­—ç¬¦ä¸²æ—¶ä½¿ç”¨ï¼›
    + intï¼š8ä¸ªå­—èŠ‚çš„é•¿æ•´å‹æ—¶ä½¿ç”¨ï¼›
    + rawï¼š<39ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²æ—¶ä½¿ç”¨ã€‚
  + Hashï¼šå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€ç”¨æˆ·ä¸»é¡µè®¿é—®é‡ã€ç»„åˆæŸ¥è¯¢
    + åº•å±‚å®ç°ï¼šziplistï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰æˆ–è€…hashtableï¼ˆå­—å…¸æˆ–è€…ä¹Ÿå«å“ˆå¸Œè¡¨ï¼‰
  + Listï¼šå¾®åšå…³æ³¨äººæ—¶é—´è½´åˆ—è¡¨ã€ç®€å•é˜Ÿåˆ—
    + åº•å±‚å®ç°ï¼šquicklistï¼ˆå¿«é€Ÿåˆ—è¡¨ï¼Œæ˜¯ziplist å‹ç¼©åˆ—è¡¨ å’Œlinkedlist åŒç«¯é“¾è¡¨ çš„ç»„åˆï¼‰
    + linkedlistï¼ˆåŒç«¯é“¾è¡¨ï¼‰
    + ziplistï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰:å½“ä¸€ä¸ªåˆ—è¡¨é”®åªåŒ…å«å°‘é‡åˆ—è¡¨é¡¹ï¼Œä¸”æ˜¯å°æ•´æ•°å€¼æˆ–é•¿åº¦æ¯”è¾ƒçŸ­çš„å­—ç¬¦ä¸²æ—¶ä½¿ç”¨ï¼›
  + Setï¼šèµã€è¸©ã€æ ‡ç­¾ã€å¥½å‹å…³ç³»
    + åº•å±‚å®ç°ï¼šintsetï¼ˆæ•´æ•°é›†åˆï¼‰æˆ–è€…hashtableï¼ˆå­—å…¸æˆ–è€…ä¹Ÿå«å“ˆå¸Œè¡¨ï¼‰
  + Zsetï¼šæ’è¡Œæ¦œ
    + åº•å±‚å®ç°ï¼šziplistï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰æˆ–è€…skiplistï¼ˆè·³è·ƒè¡¨ï¼‰
  
![](https://mmbiz.qpic.cn/mmbiz_png/eZzl4LXykQy8y3RicnZarvIuaS7K29Yh9gN6bpoI2kslO06oXCTP23Iv9RqvX5trhu8L1hpaz1UVAmibtNj1r0Ag/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)
![æ•°æ®å»ºæ¨¡](https://mmbiz.qpic.cn/mmbiz_png/eZzl4LXykQy8y3RicnZarvIuaS7K29Yh9SdNiaqQLhXqicly18gTw8yITomaeUr3kib3rCV1As2c5sjnqOvhLSrE2Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)
  
#### MongoDB
+ æ•°æ®åº“ï¼ˆdatabaseï¼‰
+ é›†åˆï¼ˆcollectionï¼‰
+ æ–‡æ¡£å¯¹è±¡ï¼ˆdocumentï¼‰

![ä¼˜åŠ¿](https://img-blog.csdn.net/20170209135023925?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGluZmVubGlhbmc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
![åŠ£åŠ¿](https://img-blog.csdn.net/20170209135035046?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGluZmVubGlhbmc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

### äº‹åŠ¡
#### 3ç§å¹¶å‘é—®é¢˜
+ è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡çš„æœªæäº¤çš„æ•°æ®ï¼›
+ ä¸å¯é‡å¤è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤çš„ update çš„æ•°æ®å¯¼è‡´å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸ä¸€è‡´ï¼›
+ è™šå¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤çš„ insert çš„æ•°æ®å¯¼è‡´å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸ä¸€è‡´ã€‚

#### å››å¤§ç‰¹æ€§
+ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼›
+ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šå¯¹æ•°æ®å®Œæ•´æ€§çº¦æŸçš„éµå¾ªï¼›
+ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼›
+ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±åº”è¯¥æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä¾¿æ˜¯åœ¨æ•°æ®åº“ç³»ç»Ÿé‡åˆ°æ•…éšœçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±æäº¤äº‹åŠ¡çš„æ“ä½œã€‚

#### 5ç§äº‹åŠ¡éš”ç¦»çº§åˆ«
+ DEFAULT è¿™æ˜¯ä¸€ä¸ªPlatfromTransactionManageré»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œä½¿ç”¨æ•°æ®åº“é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼›
  + MySQLé»˜è®¤ï¼šå¯é‡å¤è¯»
  + Oracleé»˜è®¤ï¼šå·²æäº¤è¯»
  + SQL Serveré»˜è®¤ï¼šå·²æäº¤è¯»
+ æœªæäº¤è¯»ï¼ˆread uncommitedï¼‰ï¼šè„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œè™šè¯»éƒ½æœ‰å¯èƒ½å‘ç”Ÿï¼›
+ å·²æäº¤è¯»ï¼ˆread commitedï¼‰ï¼šé¿å…è„è¯»ã€‚ä½†æ˜¯ä¸å¯é‡å¤è¯»å’Œè™šè¯»æœ‰å¯èƒ½å‘ç”Ÿï¼›
+ å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰ï¼šé¿å…è„è¯»å’Œä¸å¯é‡å¤è¯».ä½†æ˜¯è™šè¯»æœ‰å¯èƒ½å‘ç”Ÿï¼›
+ ä¸²è¡ŒåŒ–çš„ï¼ˆserializableï¼‰ï¼šé¿å…ä»¥ä¸Šæ‰€æœ‰è¯»é—®é¢˜ã€‚  

---|è„è¯»|ä¸å¯é‡å¤è¯»|å¹»è¯»|åŠ é”åè®®|
---|---|---|---|---|
æœªæäº¤è¯»|âœ”ï¸ |âœ”ï¸ |âœ”ï¸ |ä¸€çº§åŠ é”åè®®|
å·²æäº¤è¯»|âœ–ï¸ |âœ”ï¸ |âœ”ï¸ |äºŒçº§åŠ é”åè®®|
å¯é‡å¤è¯»|âœ–ï¸ |âœ–ï¸ |âœ”ï¸ |ä¸‰çº§åŠ é”åè®®|
ä¸²è¡ŒåŒ–çš„|âœ–ï¸ |âœ–ï¸ |âœ–ï¸ |ä¸¤æ®µé”åè®®|

#### åŠ é”åè®®
1) ä¸€çº§åŠ é”åè®®ï¼š
   + äº‹åŠ¡åœ¨ä¿®æ”¹æ•°æ®å‰å¿…é¡»åŠ Xé”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸï¼ˆäº‹åŠ¡ç»“æŸåŒ…æ‹¬æ­£å¸¸ç»“æŸ(COMMIT)å’Œéæ­£å¸¸ç»“æŸ(ROLLBACK)ï¼‰æ‰å¯é‡Šæ”¾ï¼›å¦‚æœä»…ä»…æ˜¯è¯»æ•°æ®ï¼Œä¸éœ€è¦åŠ é”ã€‚
   + ä¸€çº§å°é”åè®®å¯ä»¥é˜²æ­¢ä¸¢å¤±ä¿®æ”¹ï¼Œå¹¶ä¿è¯äº‹åŠ¡Tæ˜¯å¯æ¢å¤çš„ã€‚ä½¿ç”¨ä¸€çº§å°é”åè®®å¯ä»¥è§£å†³ä¸¢å¤±ä¿®æ”¹é—®é¢˜ã€‚
   + åœ¨ä¸€çº§å°é”åè®®ä¸­ï¼Œå¦‚æœä»…ä»…æ˜¯è¯»æ•°æ®ä¸å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œæ˜¯ä¸éœ€è¦åŠ é”çš„ï¼Œå®ƒä¸èƒ½ä¿è¯å¯é‡å¤è¯»å’Œä¸è¯»â€œè„â€æ•°æ®ã€‚
```
SELECT xxx FOR UPDATE;
UPDATE xxx;
```
 
2) äºŒçº§åŠ é”åè®®ï¼š
   + æ»¡è¶³ä¸€çº§åŠ é”åè®®ï¼Œä¸”äº‹åŠ¡åœ¨è¯»å–æ•°æ®ä¹‹å‰å¿…é¡»å…ˆåŠ Sé”ï¼Œè¯»å®Œåå³å¯é‡Šæ”¾Sé”ã€‚
   + äºŒçº§å°é”åè®®é™¤é˜²æ­¢äº†ä¸¢å¤±ä¿®æ”¹ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥é˜²æ­¢è¯»â€œè„â€æ•°æ®ã€‚ä½†åœ¨äºŒçº§å°é”åè®®ä¸­ï¼Œç”±äºè¯»å®Œæ•°æ®åå³å¯é‡Šæ”¾Sé”ï¼Œæ‰€ä»¥å®ƒä¸èƒ½ä¿è¯å¯é‡å¤è¯»ã€‚

3) ä¸‰çº§åŠ é”åè®®ï¼š
   + æ»¡è¶³ä¸€çº§åŠ é”åè®®ï¼Œä¸”äº‹åŠ¡åœ¨è¯»å–æ•°æ®ä¹‹å‰å¿…é¡»å…ˆåŠ Sé”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ã€‚
   + ä¸‰çº§å°é”åè®®é™¤é˜²æ­¢äº†ä¸¢å¤±ä¿®æ”¹å’Œä¸è¯»â€œè„â€æ•°æ®å¤–ï¼Œè¿˜è¿›ä¸€æ­¥é˜²æ­¢äº†ä¸å¯é‡å¤è¯»ã€‚
   
+ ä¸¤æ®µé”åè®®ï¼ˆ2-phase lockingï¼‰
  + ä¸¤æ®µé”åè®®æ˜¯æŒ‡æ¯ä¸ªäº‹åŠ¡çš„æ‰§è¡Œå¯ä»¥åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šç”Ÿé•¿é˜¶æ®µï¼ˆåŠ é”é˜¶æ®µï¼‰å’Œè¡°é€€é˜¶æ®µï¼ˆè§£é”é˜¶æ®µï¼‰ã€‚
    + åŠ é”é˜¶æ®µï¼šåœ¨è¯¥é˜¶æ®µå¯ä»¥è¿›è¡ŒåŠ é”æ“ä½œã€‚åœ¨å¯¹ä»»ä½•æ•°æ®è¿›è¡Œè¯»æ“ä½œä¹‹å‰è¦ç”³è¯·å¹¶è·å¾—Sé”ï¼Œåœ¨è¿›è¡Œå†™æ“ä½œä¹‹å‰è¦ç”³è¯·å¹¶è·å¾—Xé”ã€‚åŠ é”ä¸æˆåŠŸï¼Œåˆ™äº‹åŠ¡è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°åŠ é”æˆåŠŸæ‰ç»§ç»­æ‰§è¡Œã€‚
    + è§£é”é˜¶æ®µï¼šå½“äº‹åŠ¡é‡Šæ”¾äº†ä¸€ä¸ªå°é”ä»¥åï¼Œäº‹åŠ¡è¿›å…¥è§£é”é˜¶æ®µï¼Œåœ¨è¯¥é˜¶æ®µåªèƒ½è¿›è¡Œè§£é”æ“ä½œä¸èƒ½å†è¿›è¡ŒåŠ é”æ“ä½œã€‚
  + è‹¥å¹¶å‘æ‰§è¡Œçš„æ‰€æœ‰äº‹åŠ¡å‡éµå®ˆä¸¤æ®µé”åè®®ï¼Œåˆ™å¯¹è¿™äº›äº‹åŠ¡çš„ä»»ä½•å¹¶å‘è°ƒåº¦ç­–ç•¥éƒ½æ˜¯å¯ä¸²è¡ŒåŒ–çš„ï¼›éµå¾ªä¸¤æ®µé”åè®®çš„äº‹åŠ¡è°ƒåº¦å¤„ç†çš„ç»“æœæ˜¯å¯ä¸²è¡ŒåŒ–çš„å……åˆ†æ¡ä»¶ï¼Œä½†æ˜¯å¯ä¸²è¡ŒåŒ–å¹¶ä¸ä¸€å®šéµå¾ªä¸¤æ®µé”åè®®ã€‚
  + ä¸é˜²æ­¢æ­»é”çš„ä¸€æ¬¡å°é”æ³•çš„å¼‚åŒä¹‹å¤„ï¼šä¸€æ¬¡å°é”æ³•è¦æ±‚æ¯ä¸ªäº‹åŠ¡å¿…é¡»ä¸€æ¬¡å°†æ‰€æœ‰è¦ä½¿ç”¨çš„æ•°æ®å…¨éƒ¨åŠ é”ï¼Œå¦åˆ™å°±ä¸èƒ½ç»§ç»­æ‰§è¡Œï¼Œå› æ­¤ä¸€æ¬¡å°é”æ³•éµå®ˆä¸¤æ®µé”åè®®ï¼›ä½†æ˜¯ä¸¤æ®µé”åè®®å¹¶ä¸è¦æ±‚äº‹åŠ¡å¿…é¡»ä¸€æ¬¡å°†æ‰€æœ‰è¦ä½¿ç”¨çš„æ•°æ®å…¨éƒ¨åŠ é”ï¼Œå› æ­¤éµå®ˆä¸¤æ®µé”åè®®çš„äº‹åŠ¡å¯èƒ½å‘ç”Ÿæ­»é”ã€‚
  
#### ä¸¤/ä¸‰é˜¶æ®µæäº¤
+ 2PCï¼ˆtwo-phase commit protocolï¼‰ï¼šå¼ºä¸€è‡´ã€ä¸­å¿ƒåŒ–çš„åŸå­æäº¤åè®®ã€‚ä¸­å¿ƒåŒ–åè°ƒè€…èŠ‚ç‚¹ï¼ˆcoordinatorï¼‰å’ŒNä¸ªå‚ä¸è€…èŠ‚ç‚¹ï¼ˆpartcipantï¼‰ã€‚
  + ç¬¬ä¸€é˜¶æ®µï¼šè¯·æ±‚/è¡¨å†³é˜¶æ®µï¼›
  + ç¬¬äºŒé˜¶æ®µï¼šæäº¤/æ‰§è¡Œé˜¶æ®µã€‚
+ 3PCï¼šå¢åŠ äº†CanCommité˜¶æ®µï¼Œå¹¶å¼•å…¥äº†è¶…æ—¶æœºåˆ¶ã€‚
  + ç¬¬ä¸€é˜¶æ®µï¼šCanCommité˜¶æ®µï¼›
  + ç¬¬äºŒé˜¶æ®µï¼šPreCommité˜¶æ®µï¼›
  + ç¬¬ä¸‰é˜¶æ®µï¼šDoCommité˜¶æ®µã€‚
+ TCCï¼ˆTry-Confirm-Cancelï¼‰ï¼šè¡¥å¿äº‹åŠ¡
  + Tryé˜¶æ®µï¼šä¸»è¦æ˜¯å¯¹ä¸šåŠ¡ç³»ç»Ÿåšæ£€æµ‹åŠèµ„æºé¢„ç•™ï¼›
  + Confirmé˜¶æ®µï¼šç¡®è®¤æ‰§è¡Œä¸šåŠ¡æ“ä½œï¼›
  + Cancelé˜¶æ®µï¼šå–æ¶ˆæ‰§è¡Œä¸šåŠ¡æ“ä½œã€‚

### ç¼“å­˜
#### ç¼“å­˜ç©¿é€
+ æŸ¥è¯¢ä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ï¼Œç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­æ—¶éœ€è¦ä»æ•°æ®åº“æŸ¥è¯¢ï¼ŒæŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°æ•°æ®åº“å»æŸ¥è¯¢ï¼›
+ è§£å†³åŠæ³•ï¼š
  1) å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ä¸¢å¼ƒï¼›
  2) å¦‚æœä¸€ä¸ªæŸ¥è¯¢è¿”å›çš„æ•°æ®ä¸ºç©ºï¼Œæˆ‘ä»¬ä»ç„¶æŠŠè¿™ä¸ªç©ºç»“æœè¿›è¡Œç¼“å­˜ï¼Œä½†å®ƒçš„è¿‡æœŸæ—¶é—´ä¼šå¾ˆçŸ­ï¼Œæœ€é•¿ä¸è¶…è¿‡äº”åˆ†é’Ÿã€‚
  
#### ç¼“å­˜é›ªå´©
+ å¦‚æœç¼“å­˜é›†ä¸­åœ¨ä¸€æ®µæ—¶é—´å†…å¤±æ•ˆï¼Œå‘ç”Ÿå¤§é‡çš„ç¼“å­˜ç©¿é€ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢éƒ½è½åœ¨æ•°æ®åº“ä¸Šï¼Œé€ æˆäº†ç¼“å­˜é›ªå´©;
+ è§£å†³æ–¹æ³•ï¼š
  1) äº‹å‰ï¼šredis é«˜å¯ç”¨ï¼Œä¸»ä»+å“¨å…µï¼Œredis clusterï¼Œé¿å…å…¨ç›˜å´©æºƒã€‚
  2) äº‹ä¸­ï¼šæœ¬åœ° ehcache ç¼“å­˜ + hystrix é™æµ&é™çº§ï¼Œé¿å… MySQL è¢«æ‰“æ­»ã€‚
  3) äº‹åï¼šredis æŒä¹…åŒ–ï¼Œä¸€æ—¦é‡å¯ï¼Œè‡ªåŠ¨ä»ç£ç›˜ä¸ŠåŠ è½½æ•°æ®ï¼Œå¿«é€Ÿæ¢å¤ç¼“å­˜æ•°æ®ã€‚

### ä¼˜åŒ–
#### æ•°æ®åº“ä¼˜åŒ–
+ é€‰æ‹©åˆé€‚çš„å­—æ®µï¼›å°½é‡å§å­—æ®µè®¾ç½®ä¸ºnot nullï¼Œè¿™æ ·æŸ¥è¯¢æ—¶ä¸éœ€è¦æ¯”è¾ƒnullï¼›
+ ä½¿ç”¨å…³è”æŸ¥è¯¢ï¼ˆleft join onï¼‰ä»£æ›¿å­æŸ¥è¯¢ï¼›
+ ä½¿ç”¨è”åˆæŸ¥è¯¢ï¼ˆunionï¼‰æ‰‹åŠ¨åˆ›å»ºä¸´æ—¶è¡¨ï¼›
+ å¼€å¯äº‹åŠ¡ï¼›
+ ä½¿ç”¨å¤–é”®ä¿è¯æ•°æ®çš„å…³è”æ€§ï¼›
+ ä½¿ç”¨ç´¢å¼•æé«˜æ£€ç´¢ç‰¹å®šè¡Œçš„é€Ÿåº¦ï¼›

#### æ•°æ®åº“åˆ‡åˆ†
+ å‚ç›´æ‹†åˆ†ï¼šæŠŠè¡¨æŒ‰æ¨¡å—åˆ’åˆ†åˆ°ä¸åŒæ•°æ®åº“è¡¨ä¸­ã€‚
![å‚ç›´æ‹†åˆ†](https://mmbiz.qpic.cn/mmbiz_jpg/4MXV7svuTWL5r9fPIGouhodOCQDdD6g8pSOgLOOgraTXACO6u3Mu5ItUMgZBHCr18kiaIw88HxXFk6Cykoj8QDA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

+ æ°´å¹³æ‹†åˆ†ï¼šæŠŠä¸€ä¸ªè¡¨æŒ‰ç…§æŸç§è§„åˆ™ï¼ˆæ—¶é—´ã€ç”¨æˆ·...ï¼‰æŠŠæ•°æ®åˆ’åˆ†åˆ°ä¸åŒè¡¨æˆ–æ•°æ®åº“é‡Œã€‚
  + ä¼šå°†ä¸€æ®µæ—¶é—´ä»¥å‰çš„æ•°æ®å½’æ¡£ï¼Œå­˜æ”¾åˆ°ç±»ä¼¼HBaseè¿™ç§éå…³ç³»å‹æ•°æ®åº“ä¸­ã€‚
  + éæ¯ä¸ªæŸ¥è¯¢éƒ½èƒ½æºå¸¦åˆ†åº“åˆ†è¡¨é”®ï¼šå»ºç«‹â€œå¼‚æ„ç´¢å¼•è¡¨â€ï¼Œå³é‡‡ç”¨å¼‚æ­¥æœºåˆ¶å°†åŸè¡¨å†…çš„æ¯æ¬¡ä¸€åˆ›å»ºæˆ–æ›´æ–°ï¼Œéƒ½æ¢ä¸€ä¸ªç»´åº¦ä¿å­˜ä¸€ä»½å®Œæ•´çš„æ•°æ®è¡¨æˆ–ç´¢å¼•è¡¨ï¼Œæ‹¿ç©ºé—´æ¢æ—¶é—´ã€‚
![æ°´å¹³æ‹†åˆ†](https://mmbiz.qpic.cn/mmbiz_jpg/4MXV7svuTWL5r9fPIGouhodOCQDdD6g8wbgYho10FyQRibfe08XUyicu8gsy3pfBsz7bvohx8yKC0S5VAFdNoVJw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

#### è®¡æ•°å™¨è¡¨
+ åªæœ‰ä¸€è¡Œï¼Œæ›´æ–°ä¼šä¸²è¡Œæ‰§è¡Œ
```
update table set cnt=cnt+1 limit 1;
```
+ ä¼˜åŒ–ï¼šå¯ä»¥åŠ å…¥100è¡Œï¼Œéšæœºæ›´æ–°
```
update table set cnt=cnt+1 where id=RAND()*100 limit 1;
```
æŸ¥è¯¢è®¡æ•°ï¼š
```
select sun(cnt) from table;
```

#### SQLæŠ€å·§
+ æ ¹æ®å·²æœ‰çš„è¡¨åˆ›å»ºæ–°è¡¨
```
create table tab_new like tab_old 
```
```
create table tab_new as select col1,col2â€¦ from tab_old definition only
```
+ å¤åˆ¶è¡¨ï¼ˆåªå¤åˆ¶ç»“æ„ï¼‰
```
select * into tab_new from tab_old where 1<>1ï¼ˆä»…ç”¨äºSQlServerï¼‰
```
```
select top 0 * into tab_new from tab_old
```
+ åˆ é™¤é‡å¤è®°å½•
```
delete from tablename where id not in (select max(id) from tablename group by col1,col2,...)ï¼ˆæ¨èï¼‰
```
```
select distinct * into temp from tablename
delete from tablename
insert into tablename select * from temp
```
+ éšæœºå–å‡º10æ¡æ•°æ®
```
select top 10 * from tablename order by newid()
```
+ åˆ†ç»„æŸ¥è¯¢æ¯ç»„å‰ä¸‰
```
select t3.id,t3.country,t3.score 
from (select t1.*, (select count(*) 
                    from tb_score t2 
                    where t1.score<=t2.score and t1.country=t2.country) as rownum 
      from tb_score t1) t3 
where rownum <=3 order by country,score DESC;
```
```
select a.id,a.country,a.name,a.score 
from tb_score a 
where exists 
      (select count(*) 
       from tb_score 
       where country = a.country and score > a.score having Count(*) < 3)
order by a.country,score DESC;
```
```
 select a.id,a.country,a.name,a.score 
 from tb_score a 
 where 
      (select count(*) 
       from tb_score 
       where country = a.country  //ç¡®å®šåˆ†ç»„å­—æ®µ
       and score > a.score   //æ’åºæ¡ä»¶
       )<3  //å–å‰ä¸‰æ¡æ•°æ®ï¼Œå¯ä»¥å¤šæ¬¡ä¿®æ”¹
 order by a.country,score DESC;
```
+ æŒ‰æ•°å­—å¤§å°æ’åºStringå­—æ®µ str
```
 SELECT * FROM  tb WHERE 1 = 1 ORDER BY -str DESC  
```
```
 SELECT * FROM  tb WHERE 1 = 1 ORDER BY (str + 1)   
```
  
### åŸºç¡€çŸ¥è¯†
#### ä¸‰å¤§èŒƒå¼
+ ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ï¼š
æ¯ä¸€åˆ—éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„åŸå­æ•°æ®é¡¹ï¼›
+ ç¬¬äºŒèŒƒå¼ï¼š
æ»¡è¶³1NFåï¼Œè¦æ±‚è¡¨ä¸­çš„æ‰€æœ‰åˆ—ï¼Œéƒ½å¿…é¡»ä¾èµ–äºä¸»é”®ï¼Œè€Œä¸èƒ½æœ‰ä»»ä½•ä¸€åˆ—ä¸ä¸»é”®æ²¡æœ‰å…³ç³»ï¼ˆä¸€ä¸ªè¡¨åªæè¿°ä¸€ä»¶äº‹æƒ…ï¼‰ï¼›
+ ç¬¬ä¸‰èŒƒå¼ï¼š
åœ¨2NFåŸºç¡€ä¸Šï¼Œè¡¨ä¸­çš„æ¯ä¸€åˆ—åªèƒ½ä¾èµ–äºä¸»é”®ï¼ˆåœ¨2NFåŸºç¡€ä¸Šæ¶ˆé™¤ä¼ é€’ä¾èµ–ï¼‰ã€‚

#### äº”å¤§çº¦æŸ
+ ä¸»é”®çº¦æŸï¼ˆPrimay Key Coustraintï¼‰ï¼šå”¯ä¸€æ€§ï¼Œéç©ºæ€§ï¼›  
```
alter table stuInfo
add constraint PK_stuNo primary key (stuNo)
```
+ å”¯ä¸€çº¦æŸï¼ˆUnique Counstraintï¼‰ï¼šå”¯ä¸€æ€§ï¼Œå¯ä»¥ç©ºï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªï¼›  
```
alter table stuInfo
add constraint UQ_stuID unique(stuID)
```
+ æ£€æŸ¥çº¦æŸ (Check Counstraint) ï¼šå¯¹è¯¥åˆ—æ•°æ®çš„èŒƒå›´ã€æ ¼å¼çš„é™åˆ¶ï¼ˆå¦‚ï¼šå¹´é¾„ã€æ€§åˆ«ç­‰ï¼‰ï¼›  
```
alter table stuInfo
add constraint CK_stuAge check (stuAge between 15 and 40)
```
+ é»˜è®¤çº¦æŸ (Default Counstraint) ï¼šè¯¥æ•°æ®çš„é»˜è®¤å€¼ï¼›  
```
alter table stuInfo
add constraint DF_stuAddress default (â€˜åœ°å€ä¸è¯¦â€™) for stuAddress
```
+ å¤–é”®çº¦æŸ (Foreign Key Counstraint) ï¼šéœ€è¦å»ºç«‹ä¸¤è¡¨é—´çš„å…³ç³»å¹¶å¼•ç”¨ä¸»è¡¨çš„åˆ—ã€‚  
```
alter table stuInfo
add constraint FK_stuNo foreign key(stuNo)references stuinfo(stuNo)
```

#### ç´¢å¼•
+ ä½¿ç”¨æ—¶æœº
  + ç»å¸¸å‡ºç°åœ¨ group by,order by å’Œ distinc å…³é”®å­—åé¢çš„å­—æ®µï¼›
  + ç»å¸¸ä¸å…¶ä»–è¡¨è¿›è¡Œè¿æ¥çš„è¡¨ï¼Œåœ¨è¿æ¥å­—æ®µä¸Šåº”è¯¥å»ºç«‹ç´¢å¼•ï¼›
  + ç»å¸¸å‡ºç°åœ¨ Where å­å¥ä¸­çš„å­—æ®µï¼›
  + ç»å¸¸å‡ºç°ç”¨ä½œæŸ¥è¯¢é€‰æ‹©çš„å­—æ®µã€‚
+ å•åˆ—ç´¢å¼•
  + å¤šä¸ªå•åˆ—ç´¢å¼•åœ¨å¤šæ¡ä»¶æŸ¥è¯¢æ—¶åªä¼šç”Ÿæ•ˆç¬¬ä¸€ä¸ªç´¢å¼•ï¼›
+ è”åˆç´¢å¼•
  + æœ€å·¦å‰ç¼€åŸåˆ™ï¼šä»¥æœ€å·¦è¾¹çš„ä¸ºèµ·ç‚¹ä»»ä½•è¿ç»­çš„ç´¢å¼•éƒ½èƒ½åŒ¹é…ä¸Šï¼›
  + å½“åˆ›å»º(a,b,c)è”åˆç´¢å¼•æ—¶ï¼Œç›¸å½“äºåˆ›å»ºäº†(a)å•åˆ—ç´¢å¼•ï¼Œ(a,b)è”åˆç´¢å¼•ä»¥åŠ(a,b,c)è”åˆç´¢å¼•ï¼ˆa,cç»„åˆä¹Ÿå¯ä»¥ï¼Œä½†å®é™…ä¸Šåªç”¨åˆ°äº†açš„ç´¢å¼•ï¼Œcå¹¶æ²¡æœ‰ç”¨åˆ°ï¼ï¼‰ã€‚
+ ç´¢å¼•å¤±æ•ˆ
  + where å­å¥ä¸­ä½¿ç”¨ != ã€or ã€<> ã€å‡½æ•°æ“ä½œï¼Œå¼•æ“å°†æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼›
  + å¤šåˆ—ç´¢å¼•ï¼Œä¸ä½¿ç”¨çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼›
  + åˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¸€å®šè¦åœ¨æ¡ä»¶ä¸­å°†æ•°æ®ä½¿ç”¨å¼•å·å¼•ç”¨èµ·æ¥ï¼Œå¦åˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼›
  + likeçš„æ¨¡ç³ŠæŸ¥è¯¢ä»¥ % å¼€å¤´ï¼Œç´¢å¼•å¤±æ•ˆï¼›
  + å¦‚æœMySQLä¼°è®¡ä½¿ç”¨å…¨è¡¨æ‰«æè¦æ¯”ä½¿ç”¨ç´¢å¼•å¿«ï¼Œåˆ™ä¸ä½¿ç”¨ç´¢å¼•ã€‚

#### count(1) count(ä¸»é”®) count(\*)
+ count(1) å’Œ count(ä¸»é”®) è¿™ä¸¤ä¸ªåªæ‰«æä¸»é”®Indexå°±å¯ä»¥å¾—åˆ°æ•°æ®
+ count(\*) æ˜¯æ‰«æè¡¨çš„
+ count(ä¸»é”®)>count(1)= count(\*)
+ count(ROWID) è¿™ä¹Ÿæ˜¯åªæ‰«æIndexçš„ï¼Œæ•ˆç‡é«˜

#### Limit 
+ LIMIT N,Mï¼šLIMITé¦–å…ˆè¦æ‰¾æŸ¥ N+M è¡Œï¼Œç„¶åä»Nè¡Œå¤„ï¼Œå–Mè¡Œã€‚
+ ä¼˜åŒ–ï¼šè®©Nå˜çš„å°½å¯èƒ½çš„å°æˆ–æ˜¯ä¸ç”¨
```
åŸæŸ¥è¯¢ï¼šSELECT * FROM pw_gbook WHERE uid='48' ORDER BY postdate DESC LIMIT 1275480,20;
è½¬æ¢æˆï¼šSELECT * FROM pw_gbook WHERE id>1275480 and uid='48' ORDER BY postdate DESC LIMIT 20;
```

#### Select For update
+ InnoDB ä½¿ç”¨è¡Œé”å®šï¼ŒBDB ä½¿ç”¨é¡µé”å®šï¼ŒMyISAM ä½¿ç”¨è¡¨é”ï¼›